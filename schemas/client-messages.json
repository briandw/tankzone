{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "https://battlezone.game/schemas/client-messages.json",
  "title": "Client to Server Messages",
  "description": "JSON schema for messages sent from client to server",
  
  "type": "object",
  "required": ["type"],
  "discriminator": {
    "propertyName": "type"
  },
  
  "oneOf": [
    {
      "type": "object",
      "description": "Real-time player input (WASD + mouse)",
      "required": ["type", "forward", "backward", "strafe_left", "strafe_right", "mouse_x", "mouse_y"],
      "properties": {
        "type": { "const": "playerInput" },
        "forward": {
          "type": "boolean",
          "description": "W key pressed (move forward)"
        },
        "backward": {
          "type": "boolean", 
          "description": "S key pressed (move backward)"
        },
        "strafe_left": {
          "type": "boolean",
          "description": "A key pressed (turn left)"
        },
        "strafe_right": {
          "type": "boolean",
          "description": "D key pressed (turn right)"
        },
        "mouse_x": {
          "type": "number",
          "description": "Mouse horizontal movement (turret yaw in radians)"
        },
        "mouse_y": {
          "type": "number",
          "description": "Mouse vertical movement (turret pitch in radians)"
        }
      },
      "additionalProperties": false
    },
    
    {
      "type": "object",
      "description": "Fire bullet command",
      "required": ["type"],
      "properties": {
        "type": { "const": "fireCommand" }
      },
      "additionalProperties": false
    },
    
    {
      "type": "object",
      "description": "Chat message from player",
      "required": ["type", "message"],
      "properties": {
        "type": { "const": "chatMessage" },
        "message": {
          "type": "string",
          "minLength": 1,
          "maxLength": 500,
          "description": "Chat message text"
        }
      },
      "additionalProperties": false
    },
    
    {
      "type": "object",
      "description": "Ping request for latency testing",
      "required": ["type"],
      "properties": {
        "type": { "const": "ping" }
      },
      "additionalProperties": false
    },
    
    {
      "type": "object",
      "description": "Legacy player position update (deprecated)",
      "required": ["type", "position", "rotation", "turret_rotation"],
      "properties": {
        "type": { "const": "playerUpdate" },
        "position": {
          "type": "array",
          "items": { "type": "number" },
          "minItems": 3,
          "maxItems": 3,
          "description": "Player position [x, y, z]"
        },
        "rotation": {
          "type": "array",
          "items": { "type": "number" },
          "minItems": 3,
          "maxItems": 3,
          "description": "Player rotation [pitch, yaw, roll]"
        },
        "turret_rotation": {
          "type": "array",
          "items": { "type": "number" },
          "minItems": 3,
          "maxItems": 3,
          "description": "Turret rotation [pitch, yaw, roll]"
        }
      },
      "additionalProperties": false
    },
    
    {
      "type": "object",
      "description": "Legacy bullet fired event (deprecated)",
      "required": ["type", "position", "velocity"],
      "properties": {
        "type": { "const": "bulletFired" },
        "position": {
          "type": "array",
          "items": { "type": "number" },
          "minItems": 3,
          "maxItems": 3,
          "description": "Bullet spawn position [x, y, z]"
        },
        "velocity": {
          "type": "array",
          "items": { "type": "number" },
          "minItems": 3,
          "maxItems": 3,
          "description": "Bullet velocity vector [vx, vy, vz]"
        }
      },
      "additionalProperties": false
    },
    
    {
      "type": "object",
      "description": "Legacy bullet hit event (deprecated)",
      "required": ["type", "bullet_id", "target_player_id", "damage"],
      "properties": {
        "type": { "const": "bulletHit" },
        "bullet_id": {
          "type": "string",
          "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
          "description": "UUID of the bullet that hit"
        },
        "target_player_id": {
          "type": "string",
          "minLength": 1,
          "description": "ID of the player that was hit"
        },
        "damage": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Damage amount dealt"
        }
      },
      "additionalProperties": false
    }
  ]
} 