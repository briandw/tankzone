<!DOCTYPE html>
<html>
<head>
    <title>Mouse Control Debug</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        #canvas { border: 1px solid #ccc; cursor: pointer; }
        #info { margin-top: 10px; }
        .value { font-weight: bold; color: #0066cc; }
    </style>
</head>
<body>
    <h1>Mouse Control Debug</h1>
    <p>Click the canvas and move your mouse to test the controls:</p>
    
    <canvas id="canvas" width="400" height="300"></canvas>
    
    <div id="info">
        <div>Mouse X: <span id="mouseX" class="value">0</span></div>
        <div>Mouse Y: <span id="mouseY" class="value">0</span></div>
        <div>Movement X: <span id="movementX" class="value">0</span></div>
        <div>Movement Y: <span id="movementY" class="value">0</span></div>
        <div>Pointer Locked: <span id="locked" class="value">false</span></div>
        <div>Expected: Move mouse RIGHT ‚Üí mouseX should INCREASE (positive direction)</div>
        <div>Expected: Move mouse LEFT ‚Üí mouseX should DECREASE (negative direction)</div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        let mouseX = 0;
        let mouseY = 0;
        let isLocked = false;
        const sensitivity = 0.002;
        
        // Update display
        function updateDisplay() {
            document.getElementById('mouseX').textContent = mouseX.toFixed(3);
            document.getElementById('mouseY').textContent = mouseY.toFixed(3);
            document.getElementById('locked').textContent = isLocked;
            
            // Draw on canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw center point
            ctx.fillStyle = '#ccc';
            ctx.fillRect(canvas.width/2 - 1, canvas.height/2 - 1, 2, 2);
            
            // Draw mouse position indicator
            const x = canvas.width/2 + mouseX * 100; // Scale for visibility
            const y = canvas.height/2 + mouseY * 100;
            
            ctx.fillStyle = '#ff0000';
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, 2 * Math.PI);
            ctx.fill();
            
            // Draw direction indicator
            ctx.strokeStyle = '#0066cc';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(canvas.width/2, canvas.height/2);
            ctx.lineTo(x, y);
            ctx.stroke();
        }
        
        // Pointer lock events
        canvas.addEventListener('click', () => {
            if (!isLocked) {
                canvas.requestPointerLock();
            }
        });
        
        document.addEventListener('pointerlockchange', () => {
            isLocked = document.pointerLockElement === canvas;
            updateDisplay();
        });
        
        // Mouse movement
        document.addEventListener('mousemove', (event) => {
            if (!isLocked) return;
            
            // Update movement display
            document.getElementById('movementX').textContent = event.movementX;
            document.getElementById('movementY').textContent = event.movementY;
            
            // Test both directions
            console.log('=== Mouse Movement Test ===');
            console.log('event.movementX:', event.movementX);
            console.log('event.movementY:', event.movementY);
            
            // Current implementation (what we have now)
            const currentMouseX = mouseX + event.movementX * sensitivity;
            const currentMouseY = mouseY + event.movementY * sensitivity;
            
            // Alternative implementation (negated)
            const altMouseX = mouseX - event.movementX * sensitivity;
            const altMouseY = mouseY - event.movementY * sensitivity;
            
            console.log('Current implementation:');
            console.log('  mouseX would be:', currentMouseX.toFixed(3));
            console.log('  mouseY would be:', currentMouseY.toFixed(3));
            
            console.log('Alternative implementation (negated):');
            console.log('  mouseX would be:', altMouseX.toFixed(3));
            console.log('  mouseY would be:', altMouseY.toFixed(3));
            
            // Use current implementation
            mouseX = currentMouseX;
            mouseY = currentMouseY;
            
            // Clamp values
            mouseX = Math.max(-2, Math.min(2, mouseX));
            mouseY = Math.max(-2, Math.min(2, mouseY));
            
            updateDisplay();
            
            // Log expected behavior
            if (event.movementX > 0) {
                console.log('‚úÖ Moving mouse RIGHT - mouseX should INCREASE');
                console.log('   Current mouseX:', mouseX.toFixed(3), '(should be positive/increasing)');
            } else if (event.movementX < 0) {
                console.log('‚úÖ Moving mouse LEFT - mouseX should DECREASE');
                console.log('   Current mouseX:', mouseX.toFixed(3), '(should be negative/decreasing)');
            }
        });
        
        // Reset button
        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space') {
                mouseX = 0;
                mouseY = 0;
                updateDisplay();
                console.log('üîÑ Reset mouse position');
            }
        });
        
        // Initial draw
        updateDisplay();
        
        console.log('üñ±Ô∏è Mouse Control Debug Ready');
        console.log('üìã Instructions:');
        console.log('1. Click the canvas to enable pointer lock');
        console.log('2. Move mouse RIGHT - red dot should move RIGHT, mouseX should INCREASE');
        console.log('3. Move mouse LEFT - red dot should move LEFT, mouseX should DECREASE');
        console.log('4. Press SPACE to reset position');
    </script>
</body>
</html> 